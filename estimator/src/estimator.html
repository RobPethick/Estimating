<template>
  <require from="./metric"></require>
  <section class="au-animate">
    <h2>Estimating tool</h2>
    <hr />
    <div class="col-lg-7 col-md-10 col-sm-12 col-md-offset-1 col-lg-offset-0 col-sm-offset-0">
      <section>
        <h3>PERT Estimate</h3>
        <div class="pertEstimate row">
          <div class="form-group col-md-4">
            <label for="optimistic">Optimistic (h)</label>
            <input type="number" value.bind="optimisticEstimate" class="form-control" id="optimistic" placeholder="0">
          </div>
          <div class="form-group col-md-4">
            <label for="mostLikely">Most Likely (h)</label>
            <input type="number" value.bind="mostLikelyEstimate" class="form-control" id="mostLikely" placeholder="0">
          </div>
          <div class="form-group col-md-4">
            <label for="pessimistic">Pessimistic (h)</label>
            <input type="number" value.bind="pessimisticEstimate" class="form-control" id="pessimistic" placeholder="0">
          </div>
          <div class="form-group col-md-4">
            <label for="pertEstimate">PERT Average(h):</label>
            <h4 class="help-block" id="pertEstimate">${pertEstimateText}</p>
          </div>
        </div>
      </section>
      <hr/>
      <section>
        <h3>Metrics</h3>
        <div class="row metricHeader">
          <span class="metricHeaderName col-md-2">Name</span>
          <span class="metricHeaderValue col-md-1">Hours</span>
          <span class="metricHeaderPercentage col-md-1">Percentage</span>
          <div class="col-md-3"> </div>
          <span class="metricHeaderDefaultPercentage col-md-3">Default</span>
        </div>
        <div repeat.for="metric of metrics">
          <div class="row form-group">
            <metric metric.bind="metric" rate-codes.bind="rateNames"></metric>
            <button class="btn btn-danger btn-inverse" click.trigger="removeMetric(metric)"><i class="fa fa-trash"></i></button>
          </div>
        </div>
        <div class="row">
          <button class="btn btn-primary col-md-offset-11" click.trigger="addMetric()"><i class="fa fa-plus"></i></button>
        </div>
        <div class="form-group">
          <label>Total Time (including metrics):</label>
          <h4 class="help-block">${totalTime}</h4>
        </div>
      </section>
      <hr/>
      <section>
        <h3>Customer Rates</h3>   
        <div class="row">
          <div class="col-md-3">
            <label class="pull-right" for="selectCustomer">Selected Customer:</label>   
          </div>  
          <div class="col-md-4">
            <select id="selectCustomer" class="form-control" value.bind="selectedCustomer">
              <option model.bind="null">Choose...</option>
              <option repeat.for="customer of customers"
                      model.bind="customer">
                ${customer.name}
              </option>
            </select>
          </div>   
        </div>
        <div if.bind="showCustomerRatesSection">
          <div class="row">
            <div class="col-md-3"></div>
            <div class="col-md-2">Daily Rate</div>
            <div class="col-md-2">Hourly Rate</div>
            <div class="col-md-2">Hours</div>
            <div class="col-md-2">Cost</div>
          </div>
          <div class="row" repeat.for="rate of selectedCustomer.rates">
            <div class="col-md-3">
              ${rate.rateType.name}
            </div>
            <div class="col-md-2">
              <input class="form-control" value.bind="rate.ratePerDay"></input>            
            </div>
            <div class="col-md-2">
              £${rate.ratePerHourText}
            </div>
            <div class="col-md-2">
              ${rate.hoursOnRateText}
            </div>
            <div class="col-md-2">
              £${rate.costText}
            </div>
          </div>
          <div class="row">
            <div class="col-md-2 col-md-offset-7">
              <strong class="pull-right">Total:</strong>
            </div>
            <div class="col-md-2 ">£${totalCostText}</div>
          </div>
        </div>
      </section>
    </div>
    <div class="col-lg-5 col-md-10 col-sm-12 col-md-offset-1 col-lg-offset-0 col-sm-offset-0">
      <div class="resultsSection row">
        <div class="col-md-10">
          <textarea id="finalText" textcontent.bind="descriptionText" readonly="readonly" >
          </textarea>
        </div>
        <div class="col-md-2">
          <button class="btn btn-primary" click.trigger="copyTextToClipboard()">Copy</button>
        </div>
      </div>
    </div>
  </section>
</template>
